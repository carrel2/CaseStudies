parameters:

services:
    ldap:
        class: Symfony\Component\Ldap\Ldap
        arguments: ['@adapter']

    adapter:
        class: Symfony\Component\Ldap\Adapter\ExtLdap\Adapter
        arguments:
            -   host: ldap.illinois.edu
                port: 389
                encryption: tls
                options:
                    protocol_version: 3
                    referrals: false

    app.form.user:
        class: AppBundle\Form\UserType
        arguments: ['@security.token_storage']
        tags:
            - { name: form.type }

    app.logout_handler:
        class: AppBundle\LogoutHandler

    app.file_uploader:
        class: AppBundle\FileUploader
        arguments: ['%image_directory%']

    app.doctrine_animal_listener:
        class: AppBundle\EventListener\AnimalImageUploadListener
        arguments: ['@app.file_uploader']
        tags:
            - { name: doctrine.event_listener, event: prePersist }
            - { name: doctrine.event_listener, event: preUpdate }
            - { name: doctrine.event_listener, event: preRemove }

    app.token_authenticator:
      class: AppBundle\Security\TokenAuthenticator
      arguments: ['@doctrine.orm.entity_manager']

    session.handler.pdo:
      class: Symfony\Component\HttpFoundation\Session\Storage\Handler\PdoSessionHandler
      public: false
      arguments:
        - 'mysql:host=%database_host%;dbname=%database_name%'
        - { db_username: '%database_user%', db_password: '%database_password%' }

    twig.extension:
        class: AppBundle\Twig\DoctrineExtension
        arguments:
            doctrine: '@doctrine'
        tags:
            - { name: twig.extension }
