{#
	Base admin template

	Blocks:
		- stylesheets
		- header
		- body
		- footer

	Variables:
		- form: Symfony\Component\Form\FormView
#}

{% extends 'base.html.twig' %}

{% block stylesheets %}
	{{ parent() }}

	<style>
		#footer {
			position: fixed;
			bottom: 0;
			width: 100%;
			padding: 4px;
			background: white;
			border-top: solid 1px #bbb;
		}

		#body {
			margin-bottom: 45px;
		}
	</style>
{% endblock %}

{% block header %}
	{% if app.request.pathInfo == "/admin" %}
		<ul>
			<li><a href="{{ path('default') }}">Home</a></li>
			<li><a href="{{ path('user') }}">Account</a></li>

			{% if app.user.hasResults %}
				<li><a href="{{ path('results') }}">My results</a></li>
			{% endif %}

			{% if is_granted('IS_AUTHENTICATED_FULLY') %}
				<li class="right"><a href="{{ path('logout') }}">Logout</a></li>
			{% endif %}

			{% if is_granted('ROLE_SUPER_ADMIN') %}
				<li class="right"><a href="{{ path('development') }}">Development</a></li>
			{% endif %}
		</ul>
	{% else %}
		{{ parent() }}
	{% endif %}
{% endblock %}

{% block body %}
	{% if app.request.pathInfo == "/admin" %}
		<div><a href="{{ path('manageUsers') }}">Manage users</a></div>
		<div><a href="{{ path('manageAnimals') }}">Manage animals</a></div>
		<div><a href="{{ path('editCase') }}">Edit cases</a></div>
		<div><a href="{{ path('manageTests') }}">Manage tests</a></div>
		<div><a href="{{ path('manageMedications') }}">Manage medications</a></div>
		<div><a href="{{ path('import') }}">Import</a></div>
	{% elseif form %}
		{{ form_start(form, {'attr': {'id': 'admin_form'}} ) }}

			{% if form.vars.name == "user" %}
				{{ form_row(form.email) }}
				{{ form_row(form.username) }}
				{{ form_row(form.uin) }}
				{{ form_row(form.plainPassword) }}
				{{ form_row(form.newPassword) }}
				{{ form_row(form.role) }}

				{{ form_rest(form) }}

				{% if form.vars.data.hasResults() %}
					<a href="{{ path('editUserResults', {'id': form.vars.data.id }) }}">View user's results</a>
				{% endif %}
			{% else %}
				{{ form_widget(form) }}
			{% endif %}

		{{ form_end(form) }}

	{% endif %}
{% endblock %}

{% block footer %}
	<script>
		moveSubmits();
	</script>
{% endblock %}
